<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abdul Haseeb Ahmad - Medical Portfolio</title>
    <meta name="description" content="Professional medical portfolio of Abdul Haseeb Ahmad, MBBS student specializing in internal medicine and cardiology.">
    <link rel="stylesheet" href="portfolio.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
        <script src="https://apis.google.com/js/api.js"></script>
        <script src="https://accounts.google.com/gsi/client" async defer></script>
        <script>
    console.log("Google API script tag loaded!");
</script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="nav-brand">
                <h1>Medical Portfolio</h1>
                <p>Abdul Haseeb Ahmad</p>
            </div>
            <nav class="nav-menu">
                <button class="nav-item active" data-section="personal">Personal Info</button>
                <button class="nav-item" data-section="descriptive">Descriptive Portfolio</button>
                <button class="nav-item" data-section="reflective">Reflective Portfolio</button>
                <button id="export-pdf" class="nav-item" title="Export visible portfolio to PDF">Export to PDF</button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Personal Information Section -->
        <section id="personal" class="section active">
            <div class="container">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Personal Profile</h2>
                        <p class="card-description">Your professional identity, contact details, and links</p>
                        <div class="edit-controls">
                            <button id="edit-personal" class="btn btn-outline">
                                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                                    <path d="m18.5 2.5 a2.828 2.828 0 1 1 4 4L12 16l-4 1 1-4 10.5-10.5z"/>
                                </svg>
                                Edit
                            </button>
                            <button id="save-personal" class="btn btn-success hidden">
                                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                                    <polyline points="17,21 17,13 7,13 7,21"/>
                                    <polyline points="7,3 7,8 15,8"/>
                                </svg>
                                Save
                            </button>
                            <button id="cancel-personal" class="btn btn-outline hidden">
                                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <line x1="18" y1="6" x2="6" y2="18"/>
                                    <line x1="6" y1="6" x2="18" y2="18"/>
                                </svg>
                                Cancel
                            </button>
                        </div>
                    </div>
                    <div class="card-content">
                        <div class="profile-section">
                                                                <div class="profile-image-container">
                                                                <div class="avatar">
    <img src=" https://github.com/Dr-Calypso/Dr-Calypso.github.io/blob/main/profile.jpg?raw=true " alt="Profile Picture" class="avatar-image">
    <div class="avatar-fallback" style="display:none;"></div>
</div>
                                                                <input type="file" id="profile-photo-input" accept="image/*" style="display:none;" />
                                                                <button id="change-photo" class="btn btn-outline btn-sm hidden">
                                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                                        <circle cx="12" cy="13" r="4"/>
                                    </svg>
                                    Change Photo
                                </button>
                            </div>
                            <div class="profile-info">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Full Name</label>
                                        <span id="firstName-display">Abdul Haseeb Ahmad</span>
                                        <input type="text" id="firstName" value="Abdul Haseeb Ahmad" style="display:none;">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Professional Title</label>
                                    <span id="title-display">MBBS RMU 52 Student | Year 1 (Roll no. 123)</span>
                                    <input type="text" id="title" value="MBBS RMU 52 Student | Year 1 (Roll no. 123)" style="display:none;">
                                </div>
                                <div class="form-group">
                                    <label>Professional Bio</label>
                                    <span id="bio-display">Passionate medical student dedicated 1. To impart evidence based research oriented medical education. 2. To provide best possible patient care. 3. To inculcate the values of mutual respect and ethical practice of medicine
.</span>
                                    <textarea id="bio" rows="4" style="display:none;">Passionate medical student dedicated 1. To impart evidence based research oriented medical education. 2. To provide best possible patient care. 3. To inculcate the values of mutual respect and ethical practice of medicine.</textarea>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Email</label>
                                        <span id="email-display">mbbs-52-123@rmur.edu.pk</span>
                                        <input type="email" id="email" value="mbbs-52-123@rmur.edu.pk" style="display:none;">
                                    </div>
                                    <div class="form-group">
                                        <label>Phone</label>
                                        <span id="phone-display">+92 3317735568</span>
                                        <input type="tel" id="phone" value="+92 3317735568" style="display:none;">
                                    </div>
                                    <div class="form-group">
                                        <label>Location</label>
                                        <span id="location-display">Boys Hostel, Rawalpindi Medical University, Tipu Road, Rawalpindi</span>
                                        <input type="text" id="location" value="Boys Hostel, Rawalpindi Medical University, Tipu Road, Rawalpindi" style="display:none;">
                                    </div>
                                </div>
                                <div class="form-row" style="margin-top:0.75rem;">
                                    <div class="form-group">
                                        <label>LinkedIn</label>
                                        <span id="linkedin-display">linkedin.com/in/abdul-haseeb-ahmad</span>
                                        <input type="text" id="linkedin" value="linkedin.com/in/abdul-haseeb-ahmad" style="display:none;">
                                    </div>
                                    <div class="form-group" style="display:flex;align-items:center;justify-content:flex-start;gap:0.5rem;">
                                        <!-- CMS Attendance quick link placed on same horizontal line as LinkedIn -->
                                        <a id="cms-attendance" class="cms-attendance" href="https://cms.rmur.edu.pk/profile/attendance" target="_blank" rel="noopener noreferrer">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" style="margin-right:8px;">
                                                <path d="M8 7V3h8v4" stroke-linecap="round" stroke-linejoin="round"/>
                                                <rect x="3" y="7" width="18" height="13" rx="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M8 13h8" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                            <span>CMS Attendance</span>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Descriptive Portfolio Section -->
        <section id="descriptive" class="section">
            <div class="container">
                <div class="section-header">
                    <div>
                        <h2>Descriptive Portfolio</h2>
                        <p>Academic achievements, clinical experiences, and professional development</p>
                    </div>
                    <div class="section-actions">
                        <div class="search-container">
                            <input type="text" id="search-descriptive" placeholder="Search achievements..." class="search-input">
                            <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="11" cy="11" r="8"/>
                                <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                            </svg>
                        </div>
                        <!-- Category bar: full-width pill bar with dividers. On mobile, show a compact UI: one 'All' pill + a dropdown to pick other categories -->
                        <div id="descriptive-categories" class="category-bar-wrapper">
                            <button class="descriptive-category active" data-category="" aria-pressed="true">
                                <svg class="category-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/></svg>
                                <span>All</span>
                            </button>
                            <button class="descriptive-category" data-category="academic">
                                <svg class="category-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true"><path d="M12 2l9 4-9 4-9-4 9-4z"/><path d="M3 10v4a9 9 0 0 0 18 0v-4"/></svg>
                                <span>Academics</span>
                            </button>
                            <button class="descriptive-category" data-category="clinical">
                                <svg class="category-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true"><path d="M20 8v6a6 6 0 0 1-12 0V8"/><path d="M16 6a4 4 0 1 0-8 0v2"/><path d="M12 14v6"/></svg>
                                <span>Clinical</span>
                            </button>
                            <button class="descriptive-category" data-category="extracurricular">
                                <svg class="category-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true"><path d="M17 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                                <span>Extracurricular</span>
                            </button>
                            <button class="descriptive-category" data-category="research">
                                <svg class="category-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true"><path d="M6 3h12l-2 7a6 6 0 0 1-8 0L6 3z"/><path d="M8 14h8"/></svg>
                                <span>Research</span>
                            </button>
                            <!-- Mobile-only select: hidden on desktop, visible on small screens -->
                            <select id="mobile-descriptive-select" class="mobile-descriptive-select" aria-label="Choose category (mobile)">
                                <option value="">All</option>
                                <option value="academic">Academics</option>
                                <option value="clinical">Clinical</option>
                                <option value="extracurricular">Extracurricular</option>
                                <option value="research">Research</option>
                            </select>
                        </div>
                        <button id="add-achievement" class="btn btn-primary">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                            Add Achievement
                        </button>
                    </div>
                </div>

                <div class="achievements-grid" id="achievements-container">
                    <!-- Achievements will be populated by JavaScript -->
                </div>
                <!-- Category summary cards (4 equal rectangles) -->
                <div id="category-cards" class="category-cards" aria-hidden="false">
                    <div class="cat-card" data-key="academic">
                        <div class="cat-icon" aria-hidden="true">
                            <!-- nicer school / graduation cap icon -->
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L1 7l11 5 9-4.09V17a2 2 0 0 1-2 2h-2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 22v-9" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </div>
                        <div class="cat-count">0</div>
                        <div class="cat-label">Academics</div>
                    </div>
                    <div class="cat-card" data-key="clinical">
                        <div class="cat-icon" aria-hidden="true">
                            <!-- nicer stethoscope icon -->
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M20 8v6a6 6 0 0 1-12 0V8" stroke-linecap="round" stroke-linejoin="round"/><path d="M7 8V5a2 2 0 0 1 2-2h6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </div>
                        <div class="cat-count">0</div>
                        <div class="cat-label">Clinical</div>
                    </div>
                    <div class="cat-card" data-key="extracurricular">
                        <div class="cat-icon" aria-hidden="true">
                            <!-- people / activities icon -->
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M17 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="12" cy="7" r="4" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </div>
                        <div class="cat-count">0</div>
                        <div class="cat-label">Extracurricular</div>
                    </div>
                    <div class="cat-card" data-key="research">
                        <div class="cat-icon" aria-hidden="true">
                            <!-- microscope / research icon -->
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M6 3h12l-2 7a6 6 0 0 1-8 0L6 3z" stroke-linecap="round" stroke-linejoin="round"/><path d="M9 14h6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        </div>
                        <div class="cat-count">0</div>
                        <div class="cat-label">Research</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Reflective Portfolio Section -->
        <section id="reflective" class="section">
            <div class="container">
                <div class="section-header">
                    <div>
                        <h2>Reflective Portfolio</h2>
                        <p>Personal reflections, learning experiences, and professional growth</p>
                    </div>
                    <div class="section-actions">
                        <div class="search-container">
                            <input type="text" id="search-reflective" placeholder="Search reflections..." class="search-input">
                            <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="11" cy="11" r="8"/>
                                <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                            </svg>
                        </div>
                        <select id="filter-reflective" class="filter-select">
                            <option value="">All Moods</option>
                            <option value="positive">Positive</option>
                            <option value="challenging">Challenging</option>
                            <option value="neutral">Neutral</option>
                        </select>
                        <button id="add-reflection" class="btn btn-primary">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                            Add Reflection
                        </button>
                    </div>
                </div>

                <div class="reflections-container" id="reflections-container">
                    <!-- Reflections will be populated by JavaScript -->
                </div>
            </div>
        </section>
    </main>

    <!-- Modals -->
    <div id="achievement-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="achievement-modal-title">Add Achievement</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="achievement-form">
                    <div class="form-group">
                        <label for="achievement-title">Title</label>
                        <input type="text" id="achievement-title" required>
                    </div>
                    <div class="form-group">
                        <label for="achievement-category">Category</label>
                            <select id="achievement-category" required>
                            <option value="">Select Category</option>
                            <option value="academic">Academics</option>
                            <option value="clinical">Clinical</option>
                            <option value="extracurricular">Extracurricular</option>
                            <option value="research">Research</option>
                            <option value="certification">Certification</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="achievement-date">Date</label>
                        <input type="date" id="achievement-date" required>
                    </div>
                    <div class="form-group">
                        <label for="achievement-description">Description</label>
                        <textarea id="achievement-description" rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="achievement-image">Images (optional, you may select multiple)</label>
                        <input type="file" id="achievement-image" accept="image/*" multiple>
                    </div>
                    <div class="form-group">
                        <label for="achievement-ppt">PowerPoint (PPT, optional)</label>
                        <input type="file" id="achievement-ppt" accept=".ppt,.pptx,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation">
                    </div>
                    <div class="form-group">
                        <label for="achievement-pdf">PDF (optional)</label>
                        <input type="file" id="achievement-pdf" accept="application/pdf">
                    </div>
                    <div class="form-group">
                        <label for="achievement-status">Status</label>
                        <select id="achievement-status" required>
                            <option value="completed">Completed</option>
                            <option value="in-progress">In Progress</option>
                            <option value="planned">Planned</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline modal-cancel">Cancel</button>
                <button type="submit" form="achievement-form" class="btn btn-primary">Save Achievement</button>
            </div>
        </div>
    </div>

    <div id="reflection-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="reflection-modal-title">Add Reflection</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="reflection-form">
                    <div class="form-group">
                        <label for="reflection-title">Title</label>
                        <input type="text" id="reflection-title" required>
                    </div>
                    <div class="form-group">
                        <label for="reflection-date">Date</label>
                        <input type="date" id="reflection-date" required>
                    </div>
                    <div class="form-group">
                        <label for="reflection-mood">Mood</label>
                        <select id="reflection-mood" required>
                            <option value="">Select Mood</option>
                            <option value="positive">Positive</option>
                            <option value="challenging">Challenging</option>
                            <option value="neutral">Neutral</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="reflection-content">Reflection Content</label>
                        <textarea id="reflection-content" rows="8" placeholder="Write your thoughts and reflections..." required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="reflection-image">Images (optional, you may select multiple)</label>
                        <input type="file" id="reflection-image" accept="image/*" multiple>
                    </div>
                    <div class="form-group">
                        <label for="reflection-ppt">PowerPoint (PPT, optional)</label>
                        <input type="file" id="reflection-ppt" accept=".ppt,.pptx,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation">
                    </div>
                    <div class="form-group">
                        <label for="reflection-pdf">PDF (optional)</label>
                        <input type="file" id="reflection-pdf" accept="application/pdf">
                    </div>
                    <div class="form-group">
                        <label for="reflection-linked">Link to Achievement</label>
                        <select id="reflection-linked">
                            <option value="">No linked achievement</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline modal-cancel">Cancel</button>
                <button type="submit" form="reflection-form" class="btn btn-primary">Save Reflection</button>
            </div>
        </div>
    </div>

    <script src="portfolio.js"></script>
    <!-- html2canvas and jsPDF for client-side export to PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<!-- Auth status UI for GIS -->
<div id="auth-status" style="position:fixed;top:10px;right:180px;z-index:9999;background:#fff;padding:6px;border:1px solid #ccc;border-radius:6px;display:none;font-size:13px;"></div>
<button id="authorize_button" style="display:block;position:fixed;top:10px;right:10px;z-index:9999;">Sign in with Google</button>
<button id="signout_button" style="display:none;position:fixed;top:40px;right:10px;z-index:9999;">Sign out</button>
<button id="save-drive" onclick="app.saveToDrive()" style="display:none;position:fixed;top:70px;right:10px;z-index:9999;">Save to Drive</button>
<button id="load-drive" onclick="app.loadFromDrive()" style="display:none;position:fixed;top:100px;right:10px;z-index:9999;">Load from Drive</button>
<script>
// Google Identity Services (GIS) + gapi.client integration
const CLIENT_ID = '230626308317-ts08shmn77745hq81ghu5q7e2s2i0gf9.apps.googleusercontent.com';
const SCOPES = 'https://www.googleapis.com/auth/drive.file';

let tokenClient;
let accessToken = null;

function gisHandleResponse(resp) {
    console.log('GIS response', resp);
}

function initializeGisAndGapi() {
    // create the token client
    tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: CLIENT_ID,
        scope: SCOPES,
        callback: (tokenResponse) => {
            if (tokenResponse.error) {
                console.error('Token error', tokenResponse);
                return;
            }
            accessToken = tokenResponse.access_token;
            // Initialize gapi.client with the token
            gapi.client.setToken({access_token: accessToken});
            console.log('Access token set on gapi.client');
            updateAuthUIStateGIS(true);
        }
    });

    // Attach button handlers
    document.getElementById('authorize_button').addEventListener('click', () => {
        if (!tokenClient) { console.error('tokenClient not ready'); return; }
        // Request an access token; this may open a popup
        tokenClient.requestAccessToken({prompt: 'consent'});
    });

    document.getElementById('signout_button').addEventListener('click', () => {
        if (accessToken) {
            // Revoke token
            fetch('https://oauth2.googleapis.com/revoke?token=' + accessToken, {method: 'POST', headers: {'Content-type': 'application/x-www-form-urlencoded'}})
            .then(() => {
                accessToken = null;
                gapi.client.setToken({});
                updateAuthUIStateGIS(false);
                console.log('Access token revoked');
            }).catch(e => { console.error('Revoke error', e); });
        }
    });

    // Also initialize gapi.client (discovery docs can be added when needed)
    gapi.load('client', async () => {
        try{
            await gapi.client.init({});
            console.log('gapi.client initialized');
        }catch(e){ console.error('gapi.client.init error', e); }
    });

    // Poll to update UI (in case token established by popup)
    const poll = setInterval(()=>{
        try{
            const token = gapi.client.getToken && gapi.client.getToken();
            if (token && token.access_token) {
                accessToken = token.access_token;
                updateAuthUIStateGIS(true);
                clearInterval(poll);
            }
        }catch(e){}
    }, 700);
}

function updateAuthUIStateGIS(signedIn) {
    const statusDiv = document.getElementById('auth-status');
    const authBtn = document.getElementById('authorize_button');
    const signOutBtn = document.getElementById('signout_button');
    const saveBtn = document.getElementById('save-drive');
    const loadBtn = document.getElementById('load-drive');
    if (signedIn) {
        if (statusDiv) { statusDiv.innerText = 'Signed in (Drive access granted)'; statusDiv.style.display = 'block'; }
        if (authBtn) { authBtn.style.display = 'none'; }
        if (signOutBtn) { signOutBtn.style.display = 'inline-block'; }
        if (saveBtn) { saveBtn.style.setProperty('display','inline-block','important'); }
        if (loadBtn) { loadBtn.style.setProperty('display','inline-block','important'); }
        console.log('Auth UI updated: signedIn true - save/load buttons shown (forced)');
    } else {
        if (statusDiv) { statusDiv.style.display = 'none'; }
        if (authBtn) { authBtn.style.display = 'block'; }
        if (signOutBtn) { signOutBtn.style.display = 'none'; }
        if (saveBtn) { saveBtn.style.setProperty('display','none','important'); }
        if (loadBtn) { loadBtn.style.setProperty('display','none','important'); }
        console.log('Auth UI updated: signedIn false - save/load buttons hidden (forced)');
    }
}

// Initialize when GIS script is ready
window.addEventListener('load', () => {
    console.log('window.load: waiting for GIS and gapi');
    const check = setInterval(()=>{
        if (window.google && google.accounts && window.gapi) {
            console.log('GIS and gapi detected, initializing');
            clearInterval(check);
            initializeGisAndGapi();
        }
    }, 300);
});
</script>
</body>
</html>

